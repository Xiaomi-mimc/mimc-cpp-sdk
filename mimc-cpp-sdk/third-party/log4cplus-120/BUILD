package(default_visibility = ["//visibility:public"])

cc_library(
	name = "log4cplus-120",
	includes = ["include"],
	hdrs = glob(["include/log4cplus/**/*.h"]),
	copts = [
		"-DHAVE_CONFIG_H",
		"-DNDEBUG",
		"-DINSIDE_LOG4CPLUS",
		"-D_GNU_SOURCE=1",
		"-D_REENTRANT",
		"-g",
		"-O2",
		"-Wall",
		"-fdiagnostics-show-caret",
		"-ftrack-macro-expansion",
		"-Wextra",
		"-pedantic",
		"-Wstrict-aliasing",
		"-Wstrict-overflow",
		"-Woverloaded-virtual",
		"-Wold-style-cast",
		"-Wc++0x-compat",
		"-Wc++11-compat",
		"-Wundef",
		"-Wshadow",
		"-Wformat",
		"-Wsuggest-attribute=format",
		"-Wsuggest-attribute=noreturn",
		"-Wno-variadic-macros",
		"-fvisibility=hidden",
		"-pthread",
		"-Wno-deprecated-declarations",
		"-Wno-unused-parameter",
		"-Wno-shadow",
	],
	linkopts = [
		"-pthread",
		"-lrt",
	],
	linkstatic = 1,
	hdrs_check = "loose",
	srcs = [
    "src/appenderattachableimpl.cxx",
    "src/appender.cxx",
    "src/asyncappender.cxx",
    "src/clogger.cxx",
    "src/configurator.cxx",
    "src/connectorthread.cxx",
    "src/consoleappender.cxx",
    "src/cygwin-win32.cxx",
    "src/env.cxx",
    "src/factory.cxx",
    "src/fileappender.cxx",
    "src/fileinfo.cxx",
    "src/filter.cxx",
    "src/global-init.cxx",
    "src/hierarchy.cxx",
    "src/hierarchylocker.cxx",
    "src/layout.cxx",
    "src/lockfile.cxx",
    "src/log4judpappender.cxx",
    "src/logger.cxx",
    "src/loggerimpl.cxx",
    "src/loggingevent.cxx",
    "src/loggingmacros.cxx",
    "src/loglevel.cxx",
    "src/loglog.cxx",
    "src/logloguser.cxx",
    "src/mdc.cxx",
    "src/ndc.cxx",
    "src/nteventlogappender.cxx",
    "src/nullappender.cxx",
    "src/objectregistry.cxx",
    "src/patternlayout.cxx",
    "src/pointer.cxx",
    "src/property.cxx",
    "src/queue.cxx",
    "src/rootlogger.cxx",
    "src/sleep.cxx",
    "src/snprintf.cxx",
    "src/socketappender.cxx",
    "src/socketbuffer.cxx",
    "src/socket.cxx",
    "src/socket-unix.cxx",
    "src/socket-win32.cxx",
    "src/stringhelper-clocale.cxx",
    "src/stringhelper.cxx",
    "src/stringhelper-cxxlocale.cxx",
    "src/stringhelper-iconv.cxx",
    "src/syncprims.cxx",
    "src/syslogappender.cxx",
    "src/threads.cxx",
    "src/timehelper.cxx",
    "src/tls.cxx",
    "src/version.cxx",
    "src/win32consoleappender.cxx",
    "src/win32debugappender.cxx",
	],
	deps = [
	],
)

cc_test(
	name = "test",
	copts = [
		"-g",
		"-O2",
		"-Wall",
		"-Wno-deprecated-declarations",
	],
	linkopts = [
		"-lrt",
	],
	srcs = [
		"tests/thread_test/main.cxx",
	],
	deps = [
		":log4cplus-120",
	],
)
